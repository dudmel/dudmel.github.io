{"version":3,"file":"cart.service.js","sourceRoot":"","sources":["file:///D:/dev/shop/tmp/broccoli_type_script_compiler-input_base_path-77EpFaED.tmp/0/src/app/shop/cart.service.ts"],"names":[],"mappings":"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","sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { ProductService, ProductModel } from '../products/product.service'\r\n\r\n@Injectable()\r\nexport class CartService {\r\n\r\n    private cart: { item: ProductModel, amount: number }[] = [];\r\n    private total = 0;\r\n\r\n    constructor(\r\n        private productService: ProductService\r\n    ) { }\r\n\r\n    query() {\r\n        return this.cart;\r\n    }\r\n\r\n    addToCart(id) {\r\n        \r\n        this.productService.get(id).then(\r\n            product => {\r\n                if (!this.cart[0]) this.cart.push( { 'item': product, 'amount': 1} );\r\n                else if (this.findInCart(id)[0]) this.findInCart(id)[0].amount++;\r\n                    else this.cart.push( { 'item': product, 'amount': 1} );\r\n            })\r\n    }\r\n    \r\n    findInCart(productId) {\r\n\r\n        return this.cart.filter(p => {\r\n            return p.item.id === productId;\r\n        })\r\n    }\r\n\r\n    removeFromCart(productId) {\r\n        console.log('removing from cart: ', productId);\r\n        this.cart = this.cart.filter(p => {\r\n        return p.item.id !== productId \r\n        })\r\n        return this.query();\r\n    }\r\n   \r\n    checkTotal() {\r\n        this.cart = this.query();\r\n        return this.cart.reduce((acc, curr) => {\r\n            return acc + curr.item.price * curr.amount },0)\r\n    }\r\n\r\n    checkAmount() {\r\n        if (this.cart) return this.cart.reduce((acc, curr) => {\r\n            return acc + curr.amount },0)\r\n        else return 0;\r\n    }\r\n\r\n    changeAmount(product, change) {\r\n\r\n        if ((product.amount > 0 && change === -1) || change === 1) product.amount += change;\r\n        this.total = this.checkTotal() \r\n    \r\n        \r\n    \r\n  }\r\n  \r\n}"]}